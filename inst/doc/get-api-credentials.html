<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">



<title>How to get your own API credentials</title>






<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">How to get your own API credentials</h1>



<p>Here we describe how to obtain two credentials that are important when working with a Google API:</p>
<ul>
<li>API key (not relevant to all APIs)</li>
<li>OAuth 2.0 client ID and secret</li>
</ul>
<p>This can be important for both users and developers:</p>
<ul>
<li>Package authors: If you are writing a package to wrap a Google API, you may provide built-in credentials so that things “just work” for your users. Regardless, you will need credentials to use during package development and in testing.</li>
<li>Package users: Wrapper packages may or may not provide default credentials. If they don’t, you are required to provide your own. Even if they do, you may prefer to bring your own.</li>
</ul>
<div id="get-a-google-cloud-platform-project" class="section level2">
<h2>Get a Google Cloud Platform project</h2>
<p>You will need a Google Cloud Platform (GCP) project to hold your credentials.</p>
<p>Go to the Google Cloud Platform Console:</p>
<ul>
<li><a href="https://console.cloud.google.com" class="uri">https://console.cloud.google.com</a></li>
<li>This may involve logging in or selecting your preferred Google identity.</li>
<li>This may involve selecting the relevant organization.</li>
</ul>
<p>This console is your general destination for inspecting and modifying your GCP projects.</p>
<p>Create a new project here, if necessary. Otherwise, select the project of interest, if you have more than one.</p>
</div>
<div id="enable-apis" class="section level2">
<h2>Enable API(s)</h2>
<p>Enable the relevant APIs(s) for your GCP project.</p>
<p>In the left sidebar, navigate to <em>APIs &amp; Services &gt; Library</em>.</p>
<p>Identify the API of interest. Click Enable.</p>
</div>
<div id="api-key" class="section level2">
<h2>API Key</h2>
<p>Some APIs accept requests to read public resources, in which case the request can be sent with an API key in lieu of a token. If this is possible, it’s a good idea to expose this, because then it’s possible to user the wrapper package in a “de-authed” mode. When using the package in a non-interactive or indirect fashion (e.g. a scheduled job on a remote server or via Shiny), it is wonderful to NOT have to manage a token, if the work can be done with an API key instead.</p>
<p><em>Some APIs aren’t really usable without a token, in which case an API key may not be relevant and you can ignore this section.</em></p>
<ul>
<li>From the Developers Console, in the target GCP Project, go to <em>APIs &amp; Services &gt; Credentials</em>.</li>
<li>Do <em>Create credentials &gt; API key</em>.</li>
<li>You can capture the new API key via clipboard right away or close this pop-up and copy it later from the Credentials page.</li>
<li>In any case, I suggest you take the opportunity to edit the API key from the Credentials page and give it a nickname.</li>
</ul>
<p>Package maintainers might want to build an API key in as a fallback, possibly taking some measures to obfuscate the key and limit its use to your package.</p>
<p>Package users could register an API key for use with a wrapper package. For example, in googledrive, one would use <code>googledrive::drive_auth_configure()</code> to store a key for use in downstream requests.</p>
</div>
<div id="oauth-client-id-and-secret" class="section level2">
<h2>OAuth client ID and secret</h2>
<p>Most APIs are used to create and modify resources on behalf of the user and these requests must include the user’s token. A regular user will generally need to send an OAuth2 token, which is obtained under the auspices of an OAuth “app” or “client”.</p>
<p>The basic steps are described in the <a href="https://developers.google.com/identity/protocols/OAuth2InstalledApp#prerequisites">Prerequisites section</a> for doing Google OAuth 2.0 for Mobile &amp; Desktop Apps:</p>
<ul>
<li>From the Developers Console, in the target GCP Project, go to <em>APIs &amp; Services &gt; Credentials</em>.</li>
<li>Do <em>Create credentials &gt; OAuth client ID</em>.</li>
<li>Select Application type “Other”.</li>
<li>You can capture the client ID and secret via clipboard right away.</li>
<li>At any time, you can navigate to a particular client ID and click “Download JSON”.</li>
</ul>
<p>Two ways to package this info for use with httr or gargle, both of which require an object of class <code>httr::oauth_app</code>:</p>
<ol style="list-style-type: decimal">
<li>Use <code>httr::oauth_app()</code>.
<ul>
<li>The client ID goes in the <code>key</code> argument.</li>
<li>The client secret goes in the <code>secret</code> argument.</li>
</ul></li>
<li>Use <code>gargle::oauth_app_from_json()</code>.
<ul>
<li>Provide the path to the downloaded JSON file.</li>
</ul></li>
</ol>
<p>In both cases, I suggest you devise a nickname for each OAuth credential and use it as the credential’s name in GCP Console and as the <code>appname</code> argument to <code>httr::oauth_app()</code> or <code>gargle::oauth_app_from_json()</code>.</p>
<p>Package maintainers might want to build this app in as a fallback, possibly taking some measures to obfuscate the client ID and secret and limit its use to your package.</p>
<ul>
<li>Note that so-called “three-legged OAuth” always requires the involvement of a user, so the word “secret” here can be somewhat confusing. It is not a secret in the same sense as a password or token. But you probably still want to store it in an opaque way, so that someone else cannot easily “borrow” it and present an OAuth consent screen that impersonates your package.</li>
</ul>
<p>Package users could register this app for use with a wrapper package. For example, in googledrive, one would use <code>googledrive::drive_auth_configure()</code> to store an app for use in downstream requests.</p>
</div>
<div id="further-reading" class="section level2">
<h2>Further reading</h2>
<p>Learn more in Google’s documentation:</p>
<ul>
<li><a href="https://support.google.com/googleapi/answer/6158857?hl=en&amp;ref_topic=7013279">Credentials, access, security, and identity</a></li>
<li><a href="https://developers.google.com/identity/protocols/OAuth2InstalledApp">Using OAuth 2.0 for Installed Applications</a></li>
</ul>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
